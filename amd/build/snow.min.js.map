{"version":3,"file":"snow.min.js","sources":["../src/snow.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Manages the very important snow.\n *\n * @module     theme_wwu2019/snow\n * @copyright  2020 Justus Dieckmann WWU\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\n\nlet canvas;\n\nlet desiredFlakes = 150;\n\n/**\n * @type {[{x: number, y: number, r: number, d: number}]}\n */\nlet flakes = [];\n\nlet intervalId = null;\n\nconst pixurl = M.cfg.wwwroot + '/theme/wwu2019/pix/';\n\nlet noise = exportNoise();\n\n/**\n * Init function\n */\nexport function init() {\n    let enableSnow = localStorage.getItem('theme_wwu2019/enable-snow') !== 'false';\n\n    $('<div class=\"mr-3\" id=\"snow-toggle\">' +\n        '<img style=\"margin-top: -6px; cursor: pointer\" width=\"35\">' +\n        '</div>').insertAfter('#main-menu-right .main-menu-additions-item');\n\n    canvas = document.createElement('canvas');\n    canvas.height = window.innerHeight;\n    canvas.width = window.innerWidth;\n    canvas.classList.add('snow');\n    canvas.style.position = 'fixed';\n    canvas.style.top = '0';\n    canvas.style.left = '0';\n    canvas.style.zIndex = '1010';\n    canvas.style.opacity = '0.8';\n    canvas.style.pointerEvents = 'none';\n    $(window).resize(() => {\n        canvas.height = window.innerHeight;\n        canvas.width = window.innerWidth;\n        desiredFlakes = 50 + canvas.height * canvas.width * 0.0001;\n    });\n\n    desiredFlakes = 50 + canvas.height * canvas.width * 0.0001;\n\n    // Loop throught the empty flakes and apply attributes\n    for (let i = 0; i < desiredFlakes; i++) {\n        flakes.push({\n            x: generateXCoord(), // Also spawn left and right of window.\n            y: Math.random() * canvas.height,\n            r: Math.random() * 5 + 2, // Min of 2px and max of 7px\n            d: Math.random() + 1 // Density of the flake\n        });\n    }\n    let ctx = canvas.getContext(\"2d\");\n\n    let snowicon = $('#snow-toggle > img');\n\n    if (enableSnow) {\n        intervalId = setInterval(redraw, 25, ctx);\n        snowicon.attr('src', pixurl + 'snow-disable.svg');\n    } else {\n        canvas.hidden = true;\n        snowicon.attr('src', pixurl + 'snow-enable.svg');\n    }\n\n    $('#snow-toggle').click(() => {\n        if (intervalId) {\n            clearInterval(intervalId);\n            intervalId = null;\n            snowicon.attr('src', pixurl + 'snow-enable.svg');\n        } else {\n            intervalId = setInterval(redraw, 25, ctx);\n            snowicon.attr('src', pixurl + 'snow-disable.svg');\n        }\n        canvas.hidden = intervalId === null;\n        localStorage.setItem('theme_wwu2019/enable-snow', intervalId !== null ? 'true' : 'false');\n    });\n\n    $('body').append(canvas);\n\n    noise.seed(Math.random());\n}\n\n// Animate the flakes\nlet angle = 0;\n\n/**\n * Move the flakes.\n */\nfunction moveFlakes() {\n    angle += 0.01;\n    let basemovement = noise.simplex2(angle * 0.1, 0) * 2.5;\n    for (let i = 0; i < flakes.length; i++) {\n        // Store current flake\n        let f = flakes[i];\n        // Update X and Y coordinates of each snowflakes\n        f.y += Math.pow(f.d, 2) + 1;\n        f.x += basemovement + Math.sin(f.d * 8 + angle) * 0.5;\n\n        // If the snowflake reaches the bottom, send a new one to the top\n        if (f.y > canvas.height + 10) {\n            if (flakes.length > desiredFlakes) {\n                flakes.splice(i, 1);\n                i--;\n            }\n            f.x = generateXCoord();\n            f.y = -10;\n        }\n    }\n    if (desiredFlakes > flakes.length && Math.random() < 0.2) {\n        flakes.push({\n            x: generateXCoord(), // Also spawn left and right of window.\n            y: -10,\n            r: Math.random() * 5 + 2, // Min of 2px and max of 7px\n            d: Math.random() + 1 // Density of the flake\n        });\n    }\n}\n\n/**\n * Generate X Coordinate\n * @returns {number} the x coordinate\n */\nfunction generateXCoord() {\n    return Math.random() * (canvas.width + 400) - 200;\n}\n\n/**\n * Redraw everything\n * @param {CanvasRenderingContext2D} ctx\n */\nfunction redraw(ctx) {\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.fillStyle = \"#cbebfa\";\n    ctx.beginPath();\n    for (let f of flakes) {\n        ctx.moveTo(f.x, f.y);\n        ctx.arc(f.x, f.y, f.r, 0, Math.PI * 2, true);\n    }\n    ctx.fill();\n    moveFlakes();\n}\n\n/*\n * A speed-improved perlin and simplex noise algorithms for 2D.\n *\n * Based on example code by Stefan Gustavson (stegu@itn.liu.se).\n * Optimisations by Peter Eastman (peastman@drizzle.stanford.edu).\n * Better rank ordering method by Stefan Gustavson in 2012.\n * Converted to Javascript by Joseph Gentle.\n *\n * Version 2012-03-09\n *\n * This code was placed in the public domain by its original author,\n * Stefan Gustavson. You may use it as you see fit, but\n * attribution is appreciated.\n *\n */\n// eslint-disable-next-line\nfunction exportNoise() {\n    /* eslint-disable */\n    var module = {};\n\n    function Grad(x, y, z) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n\n    Grad.prototype.dot2 = function (x, y) {\n        return this.x * x + this.y * y;\n    };\n\n    Grad.prototype.dot3 = function (x, y, z) {\n        return this.x * x + this.y * y + this.z * z;\n    };\n\n    var grad3 = [new Grad(1, 1, 0), new Grad(-1, 1, 0), new Grad(1, -1, 0), new Grad(-1, -1, 0),\n        new Grad(1, 0, 1), new Grad(-1, 0, 1), new Grad(1, 0, -1), new Grad(-1, 0, -1),\n        new Grad(0, 1, 1), new Grad(0, -1, 1), new Grad(0, 1, -1), new Grad(0, -1, -1)];\n\n    var p = [151, 160, 137, 91, 90, 15,\n        131, 13, 201, 95, 96, 53, 194, 233, 7, 225, 140, 36, 103, 30, 69, 142, 8, 99, 37, 240, 21, 10, 23,\n        190, 6, 148, 247, 120, 234, 75, 0, 26, 197, 62, 94, 252, 219, 203, 117, 35, 11, 32, 57, 177, 33,\n        88, 237, 149, 56, 87, 174, 20, 125, 136, 171, 168, 68, 175, 74, 165, 71, 134, 139, 48, 27, 166,\n        77, 146, 158, 231, 83, 111, 229, 122, 60, 211, 133, 230, 220, 105, 92, 41, 55, 46, 245, 40, 244,\n        102, 143, 54, 65, 25, 63, 161, 1, 216, 80, 73, 209, 76, 132, 187, 208, 89, 18, 169, 200, 196,\n        135, 130, 116, 188, 159, 86, 164, 100, 109, 198, 173, 186, 3, 64, 52, 217, 226, 250, 124, 123,\n        5, 202, 38, 147, 118, 126, 255, 82, 85, 212, 207, 206, 59, 227, 47, 16, 58, 17, 182, 189, 28, 42,\n        223, 183, 170, 213, 119, 248, 152, 2, 44, 154, 163, 70, 221, 153, 101, 155, 167, 43, 172, 9,\n        129, 22, 39, 253, 19, 98, 108, 110, 79, 113, 224, 232, 178, 185, 112, 104, 218, 246, 97, 228,\n        251, 34, 242, 193, 238, 210, 144, 12, 191, 179, 162, 241, 81, 51, 145, 235, 249, 14, 239, 107,\n        49, 192, 214, 31, 181, 199, 106, 157, 184, 84, 204, 176, 115, 121, 50, 45, 127, 4, 150, 254,\n        138, 236, 205, 93, 222, 114, 67, 29, 24, 72, 243, 141, 128, 195, 78, 66, 215, 61, 156, 180];\n    // To remove the need for index wrapping, double the permutation table length\n    var perm = new Array(512);\n    var gradP = new Array(512);\n\n    // This isn't a very good seeding function, but it works ok. It supports 2^16\n    // different seed values. Write something better if you need more seeds.\n    module.seed = function (seed) {\n        if (seed > 0 && seed < 1) {\n            // Scale the seed out\n            seed *= 65536;\n        }\n\n        seed = Math.floor(seed);\n        if (seed < 256) {\n            seed |= seed << 8;\n        }\n\n        for (var i = 0; i < 256; i++) {\n            var v;\n            if (i & 1) {\n                v = p[i] ^ (seed & 255);\n            } else {\n                v = p[i] ^ ((seed >> 8) & 255);\n            }\n\n            perm[i] = perm[i + 256] = v;\n            gradP[i] = gradP[i + 256] = grad3[v % 12];\n        }\n    };\n\n    module.seed(0);\n\n    // Skewing and unskewing factors for 2, 3, and 4 dimensions\n    var F2 = 0.5 * (Math.sqrt(3) - 1);\n    var G2 = (3 - Math.sqrt(3)) / 6;\n\n    // 2D simplex noise\n    module.simplex2 = function(xin, yin) {\n        var n0, n1, n2; // Noise contributions from the three corners\n        // Skew the input space to determine which simplex cell we're in\n        var s = (xin + yin) * F2; // Hairy factor for 2D\n        var i = Math.floor(xin + s);\n        var j = Math.floor(yin + s);\n        var t = (i + j) * G2;\n        var x0 = xin - i + t; // The x,y distances from the cell origin, unskewed.\n        var y0 = yin - j + t;\n        // For the 2D case, the simplex shape is an equilateral triangle.\n        // Determine which simplex we are in.\n        var i1, j1; // Offsets for second (middle) corner of simplex in (i,j) coords\n        if (x0 > y0) { // Lower triangle, XY order: (0,0)->(1,0)->(1,1)\n            i1 = 1;\n            j1 = 0;\n        } else {    // Upper triangle, YX order: (0,0)->(0,1)->(1,1)\n            i1 = 0;\n            j1 = 1;\n        }\n        // A step of (1,0) in (i,j) means a step of (1-c,-c) in (x,y), and\n        // a step of (0,1) in (i,j) means a step of (-c,1-c) in (x,y), where\n        // c = (3-sqrt(3))/6\n        var x1 = x0 - i1 + G2; // Offsets for middle corner in (x,y) unskewed coords\n        var y1 = y0 - j1 + G2;\n        var x2 = x0 - 1 + 2 * G2; // Offsets for last corner in (x,y) unskewed coords\n        var y2 = y0 - 1 + 2 * G2;\n        // Work out the hashed gradient indices of the three simplex corners\n        i &= 255;\n        j &= 255;\n        var gi0 = gradP[i + perm[j]];\n        var gi1 = gradP[i + i1 + perm[j + j1]];\n        var gi2 = gradP[i + 1 + perm[j + 1]];\n        // Calculate the contribution from the three corners\n        var t0 = 0.5 - x0 * x0 - y0 * y0;\n        if (t0 < 0) {\n            n0 = 0;\n        } else {\n            t0 *= t0;\n            n0 = t0 * t0 * gi0.dot2(x0, y0); // (x,y) of grad3 used for 2D gradient\n        }\n        var t1 = 0.5 - x1 * x1 - y1 * y1;\n        if (t1 < 0) {\n            n1 = 0;\n        } else {\n            t1 *= t1;\n            n1 = t1 * t1 * gi1.dot2(x1, y1);\n        }\n        var t2 = 0.5 - x2 * x2 - y2 * y2;\n        if (t2 < 0) {\n            n2 = 0;\n        } else {\n            t2 *= t2;\n            n2 = t2 * t2 * gi2.dot2(x2, y2);\n        }\n        // Add contributions from each corner to get the final noise value.\n        // The result is scaled to return values in the interval [-1,1].\n        return 70 * (n0 + n1 + n2);\n    };\n\n    // ##### Perlin noise stuff\n\n    function fade(t) {\n        return t * t * t * (t * (t * 6 - 15) + 10);\n    }\n\n    function lerp(a, b, t) {\n        return (1 - t) * a + t * b;\n    }\n\n    // 2D Perlin Noise\n    module.perlin2 = function (x, y) {\n        // Find unit grid cell containing point\n        var X = Math.floor(x), Y = Math.floor(y);\n        // Get relative xy coordinates of point within that cell\n        x = x - X;\n        y = y - Y;\n        // Wrap the integer cells at 255 (smaller integer period can be introduced here)\n        X = X & 255;\n        Y = Y & 255;\n\n        // Calculate noise contributions from each of the four corners\n        var n00 = gradP[X + perm[Y]].dot2(x, y);\n        var n01 = gradP[X + perm[Y + 1]].dot2(x, y - 1);\n        var n10 = gradP[X + 1 + perm[Y]].dot2(x - 1, y);\n        var n11 = gradP[X + 1 + perm[Y + 1]].dot2(x - 1, y - 1);\n\n        // Compute the fade curve value for x\n        var u = fade(x);\n\n        // Interpolate the four results\n        return lerp(\n            lerp(n00, n10, u),\n            lerp(n01, n11, u),\n            fade(y));\n    };\n\n    return module;\n}"],"names":["canvas","enableSnow","localStorage","getItem","insertAfter","document","createElement","height","window","innerHeight","width","innerWidth","classList","add","style","position","top","left","zIndex","opacity","pointerEvents","resize","desiredFlakes","i","flakes","push","x","generateXCoord","y","Math","random","r","d","ctx","getContext","snowicon","intervalId","setInterval","redraw","attr","pixurl","hidden","click","clearInterval","setItem","append","noise","seed","M","cfg","wwwroot","module","Grad","z","prototype","dot2","this","dot3","grad3","p","perm","Array","gradP","floor","v","F2","sqrt","G2","fade","t","lerp","a","b","simplex2","xin","yin","i1","j1","s","j","x0","y0","x1","y1","x2","y2","gi0","gi1","gi2","t0","t1","t2","perlin2","X","Y","n00","n01","n10","n11","u","exportNoise","angle","clearRect","fillStyle","beginPath","f","moveTo","arc","PI","fill","basemovement","length","pow","sin","splice","moveFlakes"],"mappings":"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"}