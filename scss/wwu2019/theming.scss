@mixin light-colors {
    --wwu-bg: #fff;
    --wwu-bg-1: #{darken(#fff, 3%)};
    --wwu-bg-2: #{darken(#fff, 6%)};
    --wwu-bg-3: #{darken(#fff, 9%)};
    --wwu-bg-4: #{darken(#fff, 12%)};
    --wwu-bg-5: #{darken(#fff, 15%)};
    --wwu-fg: #373a3c;
    --wwu-fg-1: #5a5f65;
    --wwu-fg-2: #7b8188;
    --wwu-muted-bg: #ddd;
    --wwu-muted-fg: #ced4da;
    --wwu-contrast-fg: #000;
    --wwu-outlinegrey: #bec6c8;
    --wwu-dividergrey: #423c39;
    --wwu-learnwebblue: #{$learnwebblue};
    --wwu-learnwebblue-highlight: #{darken($learnwebblue, 15%)};
    --wwu-learnwebblue-og: #{$learnwebblue};

    --wwu-tab-bg-inactive: #e1e6ec;
    --wwu-tab-fg-inactive: #495057;

    --wwu-success-bg: #dff0d8;
    --wwu-success-border: #d6e9c6;
    --wwu-success-fg: #468847;

    --wwu-info-bg: #d9edf7;
    --wwu-info-border: #bce8f1;
    --wwu-info-fg: #3a87ad;

    --wwu-warn-bg: #fcf8e3;
    --wwu-warn-border: #fbeed5;
    --wwu-warn-fg: #8a6d3b;

    --wwu-error-bg: #f2dede;
    --wwu-error-border: #eed3d7;
    --wwu-error-fg: #b94a48;
}

@mixin dark-colors {
    --wwu-bg: #222;
    --wwu-bg-1: #{lighten(#222, 5%)};
    --wwu-bg-2: #{lighten(#222, 10%)};
    --wwu-bg-3: #{lighten(#222, 15%)};
    --wwu-bg-4: #{lighten(#222, 20%)};
    --wwu-bg-5: #{lighten(#222, 25%)};
    --wwu-fg: #eee;
    --wwu-fg-1: #aaa;
    --wwu-fg-2: #888;
    --wwu-muted-bg: #444;
    --wwu-muted-fg: #666;
    --wwu-contrast-fg: #eee;
    --wwu-outlinegrey: #444;
    --wwu-dividergrey: #777;
    --wwu-learnwebblue: lighten($learnwebblue, 18%);
    --wwu-learnwebblue-highlight: lighten($learnwebblue, 25%);

    --wwu-tab-bg-inactive: var(--wwu-bg-2);
    --wwu-tab-fg-inactive: #adb5bd;

    --wwu-success-bg: #2c5b2d;
    --wwu-success-border: #336c35;
    --wwu-success-fg: #dfffd0;

    --wwu-info-bg: #105273;
    --wwu-info-border: #0e6693;
    --wwu-info-fg: #c1e5f7;

    --wwu-warn-bg: #6c4700;
    --wwu-warn-border: #845700;
    --wwu-warn-fg: #ffecc8;

    --wwu-error-bg: #600000;
    --wwu-error-border: #730011;
    --wwu-error-fg: #ffc1c0;

    .only-dark {
        display: unset;
    }

    .only-light {
        display: none;
    }

    .border-bottom {
        //noinspection Stylelint
        border-bottom-color: var(--wwu-bg-3) !important;
    }

    .border-top {
        //noinspection Stylelint
        border-top-color: var(--wwu-bg-3) !important;
    }

    .border-left {
        //noinspection Stylelint
        border-left-color: var(--wwu-bg-3) !important;
    }

    .border-right {
        //noinspection Stylelint
        border-right-color: var(--wwu-bg-3) !important;
    }

    .bg-white {
        //noinspection Stylelint
        background-color: var(--wwu-bg) !important;
    }

    .bg-light {
        background-color: var(--wwu-bg-1) !important;
    }

    .border {
        border-color: var(--wwu-bg-3) !important;
    }

    #logo-header a.wwu-logo {
        filter: brightness(200);
    }

    #logo-header a.learnweb-logo {
        background-image: url(#{$wwwroot}/theme/wwu2019/pix/#{$logoprefix}_dark.svg);
    }

    #main-menu .arrow {
        filter: brightness(2);
    }

    .bg-pulse-grey {
        animation: bg-pulse-grey-dark 2s infinite linear;
    }

    @keyframes bg-pulse-grey-dark {
        0% {
            background-color: $gray-800;
        }
        50% {
            background-color: darken($gray-800, 5%);
        }
        100% {
            background-color: $gray-800;
        }
    }

    .text-dark {
        color: var(--wwu-fg-1);
    }

    .icon.wwu-monologo {
        filter: invert(1);
    }

    .list-group-item,
    [data-fieldtype="modgrade"],
    .moodle-dialogue-base .moodle-dialogue-wrap,
    .path-mod-assign [data-region="grade-panel"] .fitem.has-popout {
        background-color: var(--wwu-bg);
        border-color: rgba(white, 0.125);
    }

    .mform fieldset,
    .moodle-dialogue-base .moodle-dialogue-wrap .moodle-dialogue-hd,
    .path-mod-assign [data-region="grading-navigation-panel"],
    .path-mod-assign [data-region="grade-actions-panel"] {
        border-color: var(--wwu-bg-3);
    }

    .fp-navbar {
        background: var(--wwu-bg-2);

        .fp-toolbar .btn.btn-secondary,
        .fp-viewbar .btn.btn-secondary {
            border: 1px solid var(--wwu-muted-fg);
            border-bottom: 1px solid var(--wwu-muted-fg);
            background: var(--wwu-bg);
            color: var(--wwu-fg);
        }
    }

    .page-item .page-link {
        color: var(--wwu-learnwebblue);
        background-color: var(--wwu-bg);
        border: 1px solid var(--wwu-outlinegrey);
    }

    .page-item.active .page-link {
        color: white;
        background-color: var(--wwu-learnwebblue-og);
        border: 1px solid var(--wwu-learnwebblue-og)
    }

    .generaltable,
    table.mod-data-default-template {
        color: var(--wwu-fg);

        thead th,
        th,
        td {
            border-color: var(--wwu-bg-3);
        }

        tbody tr:nth-of-type(#{$table-striped-order}) {
            background-color: rgba(white, 0.05);
        }

        tbody tr:hover {
            color: var(--wwu-fg);
            background-color: rgba(white, 0.1);

            &.dimmed_text a:not(.menu-action) {
                color: var(--wwu-fg);
            }
        }
    }

    .table-striped {
        tbody tr:nth-of-type(#{$table-striped-order}) {
            background-color: rgba(white, 0.05);
        }
    }

    .table {
        color: var(--wwu-fg);

        thead th,
        th,
        td{
            border-color: var(--wwu-bg-3);
        }
    }

    .custom-control-label {
        &::before {
            background-color: var(--wwu-bg);
            border-color: var(--wwu-bg-5);
        }

        &::after {
            background-color: var(--wwu-bg-5);
        }
    }

    .custom-control-input:checked ~ .custom-control-label {
        &::before {
            border-color: var(--wwu-learnwebblue);
            background-color: var(--wwu-learnwebblue);
        }

        &::after {
            background-color: var(--wwu-bg);
        }
    }

    .simplesearchform .btn-submit {
        background-color: var(--wwu-bg-2);
        border-color: var(--wwu-bg-5);
        color: var(--wwu-fg-1);
    }

    .dropdown-menu {
        color: var(--wwu-fg);
        background-color: var(--wwu-bg);
        border: 1px solid rgba(white, 0.15);
    }

    .dropdown-item,
    .dropdown-item a {
        &,
        &:hover,
        &:focus {
            color: var(--wwu-fg);
        }
    }

    .dropdown-item:active, .dropdown-item:hover, .dropdown-item:focus, .dropdown-item:focus-within {
        background-color: var(--wwu-bg-2);
    }

    .path-mod-assign .gradingtable tr.unselectedrow td {
        background-color: unset;
    }

    .path-mod-assign [data-region="grade-panel"] {
        background-color: var(--wwu-bg-1);
    }

    .form-autocomplete-suggestions li {
        color: var(--wwu-fg-1);
    }

    .popover {
        background-color: var(--wwu-bg);
        border: 1px solid rgba(white, 0.2);
        color: var(--wwu-fg);
    }

    .popover-body {
        color: var(--wwu-fg);
    }

    .popover-header {
        background-color: var(--wwu-bg-1);
        border-color: var(--wwu-bg-4);
    }

    .moodle-dialogue-base .moodle-dialogue-wrap .moodle-dialogue-hd.yui3-widget-hd {
        background-color: var(--wwu-bg);
        color: var(--wwu-fg);
    }

    .yui3-button {
        color: rgba(white, 0.8);
    }

    .fp-iconview .fp-thumbnail img {
        border: 1px solid var(--wwu-bg-4);
    }

    .fp-iconview .fp-thumbnail {
        border: 1px solid var(--wwu-bg);
    }

    .file-picker .fp-content,
    .fp-iconview .fp-filename-field .fp-filename,
    .filepicker-filelist .dndupload-target,
    .filemanager-container .dndupload-target {
        background-color: var(--wwu-bg);
    }

    .popover-region-container {
        background-color: var(--wwu-bg);
        border-color: var(--wwu-bg-5);
    }

    .popover-region-header-container,
    .path-mod div.activity-information {
        border-bottom-color: var(--wwu-bg-5);
    }

    .popover-region-footer-container {
        border-top-color: var(--wwu-bg-5);
        background-color: var(--wwu-bg);
    }

    .popover-region-toggle::before {
        border-bottom-color: var(--wwu-bg-5);
    }

    .popover-region-toggle::after {
        border-bottom-color: var(--wwu-bg);
    }

    #adminsettings h3 {
        border-color: var(--wwu-bg-3);
    }

    .table-hover tbody tr:hover {
        color: unset;
        background-color: rgba(white, 0.075);
    }

    .modal-header {
        border-bottom-color: var(--wwu-bg-3);
    }

    .modal-content,
    .modchooser .modal-body .optionsummary,
    .modchooser .modal-footer {
        background-color: var(--wwu-bg);
    }

    .modal-footer {
        border-top-color: var(--wwu-bg-3);
    }

    .close {
        color: var(--wwu-fg);
    }

    hr {
        border-color: rgba(white, 0.1);
    }

    .message-app .day {
        color: var(--wwu-fg);
    }

    .message-app .btn.btn-link.btn-icon:hover,
    .message-app .btn.btn-link.btn-icon:focus {
        background-color: var(--wwu-bg-1);
    }

    .message-app .btn-link:hover,
    .message-app .btn-link:focus {
        background-color: rgba(255, 255, 255, .035);
    }

    .modchoosercontainer .optionscontainer .option .optioninfo a, .modchoosercontainer .searchresultitemscontainer .option .optioninfo a {
        color: var(--wwu-fg);
    }

    .toast .close {
        color: black;
    }

    /* Grade table */
    .path-grade-report-grader .gradeparent tr .cell,
    .path-grade-report-grader .gradeparent .floater .cell {
        background-color: var(--wwu-bg);
    }

    .path-grade-report-grader .gradeparent table,
    .path-grade-report-grader .gradeparent .cell {
        border-color: var(--wwu-bg-4);
    }

    .path-grade-report-grader .gradeparent .userrow.odd .cell,
    .path-grade-report-grader .gradeparent .floater .cell.odd,
    .path-grade-report-grader .gradeparent .heading .cell,
    .path-grade-report-grader .gradeparent .cell.category,
    .path-grade-report-grader .gradeparent .avg .cell {
        background-color: var(--wwu-bg-1);
    }

    .preferences-container .preference-table,
    .preferences-container .preference-table tr td:nth-child(2n) {
        border-color: var(--wwu-bg-3);
    }

    /* Calendar block */
    .block .minicalendar td a {
        color: var(--wwu-learnwebblue);
    }

    .calendar_event_user,
    .calendar_event_course,
    .calendar_event_category,
    .calendar_event_site,
    .calendar_event_group,
    .calendar_event_other {
        color: var(--wwu-bg);
    }

    .resourcelinkdetails,
    .resourcedetails {
        color: var(--wwu-fg-1);
    }

    .list-group-item-action:hover,
    .list-group-item-action:focus {
        color: var(--wwu-fg-1);
    }

    body.format-topcoll #toggle-all #toggles-all-closed,
    body.format-topcoll #toggle-all #toggles-all-opened {
        filter: brightness(2);
    }

    span.unread {
        background-color: #1a2f46;
    }

    pre {
        color: var(--wwu-fg);
    }

    .CodeMirror pre {
        color: black;
    }

    /* mod_quiz */
    .jschooser .choosercontainer #chooseform .instruction,
    .jschooser .choosercontainer #chooseform .typesummary,
    #page-mod-quiz-edit ul.slots li.section li.activity .instancemaxmarkcontainer,
    .choosercontainer #chooseform .selected {
        background-color: var(--wwu-bg);
    }

    #page-mod-quiz-edit ul.slots li.section .content,
    .chooserdialogue .moodle-dialogue-wrap .moodle-dialogue-bd,
    table.quizreviewsummary td.cell {
        background-color: var(--wwu-bg-1);
    }

    .choosercontainer #chooseform .option .icon,
    #questionscontainer .qtype img.icon,
    #page-mod-quiz-edit ul.slots .activityinstance img.activityicon {
        filter: invert(1);
    }

    .choosercontainer #chooseform .option label,
    #page-mod-quiz-edit ul.slots li.section li.activity .instancemaxmarkcontainer {
        border-bottom-color: var(--wwu-bg);
    }

    .choosercontainer #chooseform .options {
        border-bottom-color: var(--wwu-bg-5);
    }

    #page-mod-quiz-edit ul.slots li.section li.activity,
    #page-mod-quiz-edit .section .activity .actions,
    table.quizreviewsummary th.cell {
        background: var(--wwu-bg-2);
    }

    #page-mod-quiz-edit .slotnumber {
        background-color: var(--wwu-bg-3);
    }

    #page-mod-quiz-edit #categoryquestions .questionname, #page-mod-quiz-edit ul.slots li.activity div.activityinstance .questionname {
        color: var(--wwu-fg);
    }


    #page-mod-quiz-edit #categoryquestions .questionname,
    #page-mod-quiz-edit ul.slots li.activity div.activityinstance .questionname,
    #page-mod-quiz-edit ul.slots li.activity div.activityinstance .questiontext {
        color: var(--wwu-fg-1);
    }

    #page-mod-quiz-edit ul.slots li.section li.activity.page {
        background: transparent;
    }

    .que .info {
        background-color: var(--wwu-bg-1);
        border-color: var(--wwu-bg-5);
    }

    #page-question-type-multichoice,
    #page-question-type-calculated,
    #page-question-type-calculatedmulti,
    #page-question-type-calculatedsimple,
    #page-question-type-numerical,
    #page-question-type-shortanswer {
        div[id^="fitem_id_"],
        div[id^="fgroup_id_"] {
            &[id*="answeroptions_"],
            &[id*="answer_"],
            &[id*="fraction_"],
            &[id*="answertolerance_"],
            &[id*="answerdisplay_"],
            &[id*="feedback_"] {
                background-color: var(--wwu-bg-1);
                border-color: var(--wwu-bg-5);
            }
        }
    }

    #page-question-type-match div[id^="fitem_id_"] {
        &[id*="subquestions_"],
        &[id*="subanswers_"]{
            background-color: var(--wwu-bg-1);
            border-color: var(--wwu-bg-5);
        }
    }

    #page-question-type-ddimageortext {
        div[id^="fgroup_id_"][id*="drags_"],
        div[id^="fitem_id_"][id*="dragitem_"],
        div[id^="fitem_id_"][id*="draglabel_"] {
            background-color: var(--wwu-bg-1);
            border-color: var(--wwu-bg-5);
        }
    }

    #page-question-type-ddmarker div[id^="fitem_id_"] {
        &[id*="hint_"],
        &[id*="hintoptions_"],
        &[id*="hintclearwrong_"] {
            background-color: var(--wwu-bg-1);
            border-color: var(--wwu-bg-5);
        }
    }

    #page-question-type-match div[id^="fitem_id_"] {
        &[id*="subanswers_"],
        &[id*="subquestions_"]{
            background-color: var(--wwu-bg-1);
            border-color: var(--wwu-bg-5);
        }
    }

    #quiz-timer-wrapper #quiz-timer {
        background-color: unset;
    }

    .editor_atto_notification .atto_info {
        background-color: var(--wwu-bg-1);
    }

    /* backup */
    .path-backup .mform .root_setting,
    .path-backup .mform .grouped_settings,
    .h5p-admin-table tr,
    .h5p-data-view tr {
        &:nth-of-type(2n+1) {
            background-color: rgba(255, 255, 255, .05);
        }

        &:nth-of-type(2n) {
            background-color: unset;
        }
    }

    .path-backup .backup-section {
        background-color: var(--wwu-bg);
        border-color: var(--wwu-bg-3);
    }

    /* block_accessreview */
    .block_accessreview_success,
    .block_accessreview.block_accessreview_success.hasinfo {
        color: var(--wwu-success-fg);
        background:var(--wwu-success-bg);
        border-color: var(--wwu-success-border);
    }

    .block_accessreview_danger,
    .block_accessreview.block_accessreview_danger.hasinfo {
        color: var(--wwu-error-fg);
        background:var(--wwu-error-bg);
        border-color: var(--wwu-error-border);
    }

    .block_accessreview_warning,
    .block_accessreview.block_accessreview_warning.hasinfo {
        color: var(--wwu-warn-fg);
        background:var(--wwu-warn-bg);
        border-color: var(--wwu-warn-border);
    }

    .block_accessreview_table {
        border-color: var(--wwu-bg-3);
    }

    /** 3rd party plugin theme fixes **/
    .qn-question,
    .qn-info {
        background-color: var(--wwu-bg-3);
    }

    /* mod_moodleoverflow */
    .moodleoverflowpost.unread .row.header {
        border-bottom-color: var(--wwu-bg-3);
    }

    .mod_moodleoverflow-label-unread {
        background-color: #645800;
    }

    .mod_moodleoverflow-label-review {
        background-color: #774444;
    }

    .moodleoverflowpost .topic .author {
        color: var(--wwu-fg-1);
    }

    #moodleoverflow-root .vote[data-moodleoverflow-state] {
        filter: invert(1);
    }

    #moodleoverflow-root .vote[data-moodleoverflow-state="clicked"] {
        filter: none;
    }

    /* mod_scheduler */
    .path-mod-scheduler .maildisplay,
    .path-mod-scheduler div.commandbar,
    .path-mod-scheduler div.slotnotes,
    .path-mod-scheduler .appointmentnote {
        background-color: var(--wwu-bg-1);
    }

    /* mod_opencast */
    body.path-mod-opencast {
        .episode > a {
            color: var(--wwu-fg);
            border: 1px solid var(--wwu-bg-5);
        }

        .episode > a:hover {
            background-color: var(--wwu-bg-1);
        }

        .episode img {
            border: 1px solid var(--wwu-bg-5);
        }

        .episode .date {
            color: var(--wwu-fg-1);
        }

        .player-wrapper {
            border: 1px solid var(--wwu-bg-5);
        }
    }

    #page-mod-quiz-view table.quizattemptsummary tr.bestrow td,
    body.path-mod-quiz .gradedattempt, body.path-mod-quiz table tbody tr.gradedattempt > td {
        background-color: var(--wwu-info-bg);
        border-color: var(--wwu-info-border);
    }

    .que .formulation {
        color: var(--wwu-fg);
        background-color: var(--wwu-bg-1);
        border-color: var(--wwu-bg-3);
    }

    #plugins-check-page .pluginupdateinfo,
    #plugins-control-panel .pluginupdateinfo {
        background-color:var(--wwu-info-bg);
    }

    /** block_xp */

    .block_xp .react-numeric-input > b {
        filter: invert(1);
    }

    .block_xp .xp-bg-gray-100,
    .block_xp-level-grid .block_xp-level-no,
    .block_xp-level-grid .block_xp-level-box {
        color: black;
    }

    .block_xp .xp-text-gray-600 {
        color: var(--wwu-fg-1);
    }

    .path-mod .activity-header:not(:empty) {
        background-color: var(--wwu-bg-1);
    }

    .path-mod .activity-information .completion-info,
    .path-mod .activity-information .activity-dates {
        border-color: var(--wwu-bg-4);
    }

    // File manager.
    .filemanager .yui3-datatable-header {
        background: var(--wwu-bg) !important;
        border-bottom: 1px solid var(--wwu-bg-5) !important;
        color: var(--wwu-fg-1) !important;
    }

    .filemanager .yui3-datatable-even .yui3-datatable-cell {
        background-color: var(--wwu-bg) !important;
    }

    .filemanager .yui3-datatable-odd .yui3-datatable-cell {
        background-color: var(--wwu-bg-1) !important;
    }

    // Yui3 table.
    .yui3-skin-sam .yui3-datatable-header {
        color: var(--wwu-fg);
    }

    .yui3-skin-sam .yui3-datatable-columns .yui3-datatable-sorted,
    .yui3-skin-sam .yui3-datatable-sortable-column:hover {
        background: var(--wwu-bg-1);
    }

    .yui3-skin-sam .yui3-datatable-even .yui3-datatable-cell {
        background: var(--wwu-bg);
        &.yui3-datatable-sorted {
            background: var(--wwu-bg-1);
        }
    }

    .yui3-skin-sam .yui3-datatable-odd .yui3-datatable-cell {
        background: var(--wwu-bg-1);
        &.yui3-datatable-sorted {
            background: var(--wwu-bg-2);
        }
    }

    .yui3-skin-sam .yui3-datatable-cell,
    .yui3-skin-sam .yui3-datatable-header {
        border-color: var(--wwu-bg-3);
    }

    .yui3-skin-sam .yui3-datatable-sort-indicator {
        filter: invert(1);
    }
}


.toast {
    color: $gray-800;
}

.popover-region-container {
    overflow-y: hidden;
}

.only-dark {
    display: none;
}

:root {
    @include light-colors;
    color-scheme: light dark;

    &.dark {
        @include dark-colors;
        color-scheme: dark;
    }

    &.light {
        color-scheme: light;
    }
}

@media (prefers-color-scheme: dark) {
    :root:not(.light) {
        @include dark-colors;
    }
}
